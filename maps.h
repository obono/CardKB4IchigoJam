#pragma once

//       d0   d1     d2  d3 d4 d5 d6 d7 d8 d9 d10 d11
//A3ï¼š   esc   1      2  3  4  5  6  7  8  9  0   del
//A2:    tab   q      w  e  r  t  y  u  i  o  p
//A1:   left   up     a  s  d  f  g  h  j  k  l   enter
//A0:   down   right  z  x  c  v  b  n  m  ,  .   space

#define BIT_SHIFT   0x1000 // shift: d12
#define BIT_SYM     0x8000 // sym: d15
#define BIT_FN      0x4000 // fn: d14

enum : uint8_t {
    MODE_NONE = 0,
    MODE_SHIFT,
    MODE_SYM,
    MODE_FN,
    MODE_MAX
};

#define KBD_ROWS    4
#define KBD_COLUMNS 12

PROGMEM static const uint8_t keyCodeMap[KBD_ROWS * KBD_COLUMNS][MODE_MAX] = {
    //nor, shft,sym, fn
    {  27,  27,  27, 128 }, // ESC
    { '1', '!', '!', 129 }, // 1
    { '2', '@', '@', 130 }, // 2
    { '3', '#', '#', 131 }, // 3
    { '4', '$', '$', 132 }, // 4
    { '5', '%', '%', 133 }, // 5
    { '6', '^', '^', 134 }, // 6
    { '7', '&', '&', 135 }, // 7
    { '8', '*', '*', 136 }, // 8
    { '9', '(', '(', 137 }, // 9
    { '0', ')', ')', 138 }, // 0
    {  8 , 127,  8 , 139 }, // Delete
    {  9 ,  9 ,  9 , 140 }, // Tab
    { 'q', 'Q', '{', 141 }, // q
    { 'w', 'W', '}', 142 }, // w
    { 'e', 'E', '[', 143 }, // e
    { 'r', 'R', ']', 144 }, // r
    { 't', 'T', '/', 145 }, // t
    { 'y', 'Y', '\\',146 }, // y
    { 'u', 'U', '|', 147 }, // u
    { 'i', 'I', '~', 148 }, // i
    { 'o', 'O', '\'',149 }, // o
    { 'p', 'P', '"', 150 }, // p
    {  0 ,  0 ,  0 ,  0  }, // (no key)
    { 180, 180, 180, 152 }, // Arrow Left
    { 181, 181, 181, 153 }, // UP
    { 'a', 'A', ';', 154 }, // a
    { 's', 'S', ':', 155 }, // s
    { 'd', 'D', '`', 156 }, // d
    { 'f', 'F', '+', 157 }, // f
    { 'g', 'G', '-', 158 }, // g
    { 'h', 'H', '_', 159 }, // h
    { 'j', 'J', '=', 160 }, // j
    { 'k', 'K', '?', 161 }, // k
    { 'l', 'L',   0, 162 }, // l
    {  13,  13,  13, 163 }, // Enter
    { 182, 182, 182, 164 }, // Arrow Down
    { 183, 183, 183, 165 }, // Arrow Right
    { 'z', 'Z',  0 , 166 }, // z
    { 'x', 'X',  0 , 167 }, // x
    { 'c', 'C',  0 , 168 }, // c
    { 'v', 'V',  0 , 169 }, // v
    { 'b', 'B',  0 , 170 }, // b
    { 'n', 'N',  0 , 171 }, // n
    { 'm', 'M',  0 , 172 }, // m
    { ',', '<', '<', 173 }, // ,
    { '.', '>', '>', 174 }, // .
    { ' ', ' ', ' ', 175 }  // Space
};

PROGMEM static const uint8_t scanCodeMap[][3] = {
    // keyCode, modifier, scanCode
    { 8,   0, 0x66 }, // Backspace
    { 9,   0, 0x0D }, // Tab
    { 13,  0, 0x5A }, // Enter
    { 27,  0, 0x76 }, // ESC
    { 32,  0, 0x29 }, // Space
    { 33,  1, 0x16 }, // !
    { 34,  1, 0x52 }, // "
    { 35,  1, 0x26 }, // #
    { 36,  1, 0x25 }, // $
    { 37,  1, 0x2E }, // %
    { 38,  1, 0x3D }, // &
    { 39,  0, 0x52 }, // '
    { 40,  1, 0x46 }, // (
    { 41,  1, 0x45 }, // )
    { 42,  1, 0x3E }, // *
    { 43,  1, 0x55 }, // +
    { 44,  0, 0x41 }, // ,
    { 45,  0, 0x4E }, // -
    { 46,  0, 0x49 }, // .
    { 47,  0, 0x4A }, // /
    { 48,  0, 0x45 }, // 0
    { 49,  0, 0x16 }, // 1
    { 50,  0, 0x1E }, // 2
    { 51,  0, 0x26 }, // 3
    { 52,  0, 0x25 }, // 4
    { 53,  0, 0x2E }, // 5
    { 54,  0, 0x36 }, // 6
    { 55,  0, 0x3D }, // 7
    { 56,  0, 0x3E }, // 8
    { 57,  0, 0x46 }, // 9
    { 58,  1, 0x4C }, // :
    { 59,  0, 0x4C }, // ;
    { 60,  1, 0x41 }, // <
    { 61,  0, 0x55 }, // =
    { 62,  1, 0x49 }, // >
    { 63,  1, 0x4A }, // ?
    { 64,  1, 0x1E }, // @
    { 65,  1, 0x1C }, // A
    { 66,  1, 0x32 }, // B
    { 67,  1, 0x21 }, // C
    { 68,  1, 0x23 }, // D
    { 69,  1, 0x24 }, // E
    { 70,  1, 0x2B }, // F
    { 71,  1, 0x34 }, // G
    { 72,  1, 0x33 }, // H
    { 73,  1, 0x43 }, // I
    { 74,  1, 0x3B }, // J
    { 75,  1, 0x42 }, // K
    { 76,  1, 0x4B }, // L
    { 77,  1, 0x3A }, // M
    { 78,  1, 0x31 }, // N
    { 79,  1, 0x44 }, // O
    { 80,  1, 0x4D }, // P
    { 81,  1, 0x15 }, // Q
    { 82,  1, 0x2D }, // R
    { 83,  1, 0x1B }, // S
    { 84,  1, 0x2C }, // T
    { 85,  1, 0x3C }, // U
    { 86,  1, 0x2A }, // V
    { 87,  1, 0x1D }, // W
    { 88,  1, 0x22 }, // X
    { 89,  1, 0x35 }, // Y
    { 90,  1, 0x1A }, // Z
    { 91,  0, 0x54 }, // [
    { 92,  0, 0x5D }, // Backslash
    { 93,  0, 0x5B }, // ]
    { 94,  1, 0x36 }, // ^
    { 95,  1, 0x4E }, // _
    { 96,  0, 0x0E }, // `
    { 97,  0, 0x1C }, // a
    { 98,  0, 0x32 }, // b
    { 99,  0, 0x21 }, // c
    { 100, 0, 0x23 }, // d
    { 101, 0, 0x24 }, // e
    { 102, 0, 0x2B }, // f
    { 103, 0, 0x34 }, // g
    { 104, 0, 0x33 }, // h
    { 105, 0, 0x43 }, // i
    { 106, 0, 0x3B }, // j
    { 107, 0, 0x42 }, // k
    { 108, 0, 0x4B }, // l
    { 109, 0, 0x3A }, // m
    { 110, 0, 0x31 }, // n
    { 111, 0, 0x44 }, // o
    { 112, 0, 0x4D }, // p
    { 113, 0, 0x15 }, // q
    { 114, 0, 0x2D }, // r
    { 115, 0, 0x1B }, // s
    { 116, 0, 0x2C }, // t
    { 117, 0, 0x3C }, // u
    { 118, 0, 0x2A }, // v
    { 119, 0, 0x1D }, // w
    { 120, 0, 0x22 }, // x
    { 121, 0, 0x35 }, // y
    { 122, 0, 0x1A }, // z
    { 123, 1, 0x54 }, // {
    { 124, 1, 0x5D }, // |
    { 125, 1, 0x5B }, // }
    { 126, 1, 0x0E }, // ~
    { 127, 2, 0x71 }, // Delete
    { 129, 0, 0x05 }, // F1
    { 130, 0, 0x06 }, // F2
    { 131, 0, 0x04 }, // F3
    { 132, 0, 0x0C }, // F4
    { 133, 0, 0x03 }, // F5
    { 134, 0, 0x0B }, // F6
    { 135, 0, 0x83 }, // F7
    { 136, 0, 0x0A }, // F8
    { 137, 0, 0x01 }, // F9
    { 138, 0, 0x09 }, // F10
    { 139, 2, 0x70 }, // Insert
    { 152, 2, 0x6C }, // Home
    { 153, 2, 0x7D }, // Page Up
    { 164, 2, 0x7A }, // Page Down
    { 165, 2, 0x69 }, // End
    { 175, 0, 0x13 }, // Kana
    { 180, 2, 0x6B }, // Arrow Left
    { 181, 2, 0x75 }, // Arrow Up
    { 182, 2, 0x72 }, // Arrow Down
    { 183, 2, 0x74 }, // Arrow Right
};
